from helper import cmdline
import re

def attack(n,e,delta,m):
    result = re.findall("d = ([0-9]+)",cmdline(f"sage boneh_durfee.sage {n} {e} {delta} {m}"))
    if result:
        return int(result[0])
    else:
        return 0
#n = 28064604001271556129820014593941766966871719060402186685619579092610207886439261672117113431862166609887206266118374701449465484489402253005016113922508067024380066234016246442417929334819285097069654802451548277481455326113050978349702149820594734620094917112796187443136766175643700321937640200838084362809065343412611621805161203752516153558451261082927961291710314933567581414097935518214992109365201598652095643901833066347701880046692998935119067272695270563422087426256745123597533999483207478371090360792810302693360403488254164643916989888513014545793976054466420758036190478585164286540685378716135550811549
#e = 18531313791748691217668182004380384706960875031739170444937357234903630805405157773603533893273701769094937129046860776392248099512075805933130254418481344816358723533906241954848284386576867670796464765936597151920719744024080336278919678935839370263228326376735883509546313342081564531619645881649686682523060176833121176144557980595803904646899010258383440094226851760803657102349392975623297154061695041569419920219234437373108673297898755794868228680112329395292450215415345222693053588500482504309427817298852492235949838297400266322189108072070736948436844997938917688895952187056009196413155284647170432087745
#print(attack(n,e))
